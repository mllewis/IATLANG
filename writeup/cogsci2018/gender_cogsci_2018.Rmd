---
title: "Exploring a Causal Link between Language and Cultural Biases"
bibliography: library.bib
csl: apa6.csl
document-params: "10pt, letterpaper"

author-information: > 
    \author{{\large \bf Molly Lewis} \\ \texttt{mollyllewis@gmail.com} \\ Department of Psychology  \\ University of Wisconsin-Madison
    \And {\large \bf Gary Lupyan} \\ \texttt{lupyan@wisc.edu} \\ Department of Psychology  \\ University of Wisconsin-Madison}

abstract: 
    "The abstract."
    
keywords:
    "IAT, cultural biases, gender, linguistic relativity."
    
output: cogsci2016::cogsci_paper
---

```{r global_options, include=FALSE}
rm(list=ls())
knitr::opts_chunk$set(fig.width=3, fig.height=3, fig.crop = F, fig.pos = "tb", fig.path='figs/',
                      echo=F, warning=F, cache=T, message=F, sanitize = T)
```

```{r, libraries}
library(png)
library(grid)
library(xtable)
library(feather)
library(tidyverse)
library(countrycode)
library(broom)
```

# Introduction

# Study 1: Measuring cross-cultural gender bias

## Method
We quantified the degree of gender bias in a culture using data from the Implicit Association Task ("IAT"; [@greenwald1998measuring]). The IAT measures the strength of respondents' associations between two pairs of concepts (e.g., male-career/female-family vs.\ male-family/female-career). The underlying assumption of the measure is that concepts that are represented as more similar to each other in the cognitive system should be easier to pair together in a behavioral task, compared to two concepts that are relatively dissimilar. Concepts are paired in the task by assigning them to the same response keys in a 2AFC categorization task. In the critical blocks of the task, concepts are assigned to keys in a way that is either bias-congruent (i.e. key A = male or career; key B = female or family) or bias-incongruent (i.e. key A = male or family; key B = female or career). Participants are then presented with a word related to one of the four concepts and asked to classify it by responding with one of the two keys as quickly as possible. Slower reaction times in the bias-incongruent blocks relative to the bias-congruent blocks suggest an implicit association between the two pairs of concepts (i.e. a bias to associate male with career, and female with family). In the present study, we analyzed an exisiting dataset of IAT scores collected online from a large, culturally diverse sample (Project Implicit: https://implicit.harvard.edu/implicit/; [@nosek2002harvesting]).

## Analysis

```{r}
raw_iat_behavioral <- read_feather("data/study1/Gender-Career IAT.public.2005-2016.feather") %>%
  select(D_biep.Male_Career_all,sex, countryres,PCT_error_3467, Mn_RT_all_3467, Mn_RT_all_3, Mn_RT_all_4, Mn_RT_all_6, Mn_RT_all_7, assocareer, assofamily,N_ERROR_3, N_ERROR_4, N_ERROR_6, N_ERROR_7, N_3, N_4, N_6, N_7) %>%
    rename(overall_iat_D_score = D_biep.Male_Career_all) 

# this file is "Gender-Career/Gender-Career IAT.public.2005-2016.sav" in feather form (taken from: https://osf.io/gmewy/) 
```

```{r, get_complete_data}
MIN_PARTICIPANTS_PER_COUNTRY <- 400

raw_iat_behavioral_complete <- raw_iat_behavioral %>%
                                filter(sex %in% c("f", "m"),
                                       !is.na(countryres), 
                                       countryres != ".",
                                       !is.na(overall_iat_D_score))

country_ns <- raw_iat_behavioral_complete %>%
  count(countryres)  %>%
  filter(n >= MIN_PARTICIPANTS_PER_COUNTRY) %>%
  arrange(-n)

raw_iat_behavioral_complete_dense_country <- raw_iat_behavioral_complete %>%
  filter(countryres %in% country_ns$countryres)

```

```{r, behavioral_exclusions}
# same exclusions as Nosek, Banjali, & Greenwald (2002), pg. 104. 
iat_behavioral <- raw_iat_behavioral_complete_dense_country %>%
  filter(Mn_RT_all_3467 <= 1500, #RTs
         Mn_RT_all_3 <= 1800,
         Mn_RT_all_4 <= 1800,
         Mn_RT_all_6 <= 1800,
         Mn_RT_all_7 <= 1800) %>%
  filter(N_ERROR_3/N_3 <=.25, # errors
         N_ERROR_4/N_4 <=.25,
         N_ERROR_6/N_6 <=.25,
         N_ERROR_7/N_7 <=.25)
```


```{r, tidy_names}
iat_behavioral_tidy <- iat_behavioral %>%
        mutate(country_name = countrycode(countryres,
                                    "iso2c",
                                    "country.name"),
              country_name = replace(country_name, 
                                country_name == "Viet Nam", "Vietnam"),
              country_name = replace(country_name, 
                                country_name == "Taiwan, Province of China", "Taiwan"),
              country_name = replace(country_name, 
                                countryres == "UK", "UK"))

```

We analyze all gender IAT scores collected from respondents between 2005 and 2016 who had complete data and  were located in countries with more than `r MIN_PARTICIPANTS_PER_COUNTRY` total respondents (_N_ = `r format(nrow(raw_iat_behavioral_complete_dense_country),big.mark=",")`). We further restricted our sample based on participants' reaction times and errors using the same criteria described in Nosek, Banjai, and Greenwald (2002, pg. 104). Our final sample included `r format(nrow(iat_behavioral),big.mark=",")` participants from `r nrow(country_ns)` countries, with a median of `r format(round(median(country_ns$n)), big.mark = ",")` participants per country.

<!-- exclusion rate = nosek's (15%) --> 
Several measures have been used in the literature to describe the difference in reaction time between bias congruent and incongruent blocks  [@greenwald2003understanding]. Here, we use the best performing measure of implicit bias, "D-score," which quantifies the difference between critical blocks while also accounting for individual differences in response time.

In addition to the implicit measure, we also analyzed an explicit measure of gender bias. After completing the IAT, participants were asked, "How strongly do you associate the following with males and females?" for both the words "career" and "family." Participants indicated their response on a Likert scale ranging from female (1) to male (7).  We calculated an explicit gender bias score for each participant as the career response minus the family response, such that greater values indicated more gender bias (as for the D-score).

## Results

```{r map, fig.env="figure", fig.pos = "t", fig.align='center', fig.width=3.8, fig.height=2.5, set.cap.width=T, num.cols.cap=1, fig.cap = "IAT gender bias (D-score) for the 49 countries with available data. All countries show a gender bias, with red indicating above average and blue indicating below average bias."}
country_means_career_implicit <- iat_behavioral_tidy %>%
  group_by(country_name) %>%
  summarize(mean_iat = mean(overall_iat_D_score)) 

map_world <- map_data(map = "world") %>%
  mutate(country_name = region) %>%
  mutate(country_name = fct_recode(country_name,
    `United States of America` = "USA", 
    `Russian Federation` = "Russia",
    `Republic of Korea` = "South Korea")) 

map_data <- country_means_career_implicit %>%
  full_join(map_world) %>%
  filter(lat > -57, 
         long > -165) 

# Europe inset 
ggplot(map_data, aes(x = long, y = lat, 
                            group = group, 
                            fill = mean_iat)) + 
  scale_fill_gradient2("", breaks =  c(.3, .35, .4, .45), limits=c(.3,.45), 
                       midpoint = mean(map_data$mean_iat,
                                       na.rm = T), 
                       low = "blue", high = "red") +
  geom_polygon(color = "black", size = .1) +
  ggtitle("IAT Gender Bias") +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_rect(fill = "white"),
        axis.title = element_blank(),
        axis.text = element_blank(),
        axis.ticks = element_blank(),
        legend.position = c(.1, .35),
        legend.background = element_rect(fill=alpha('white', 0)),
        legend.key.size = unit(0.2, "in"),
        legend.text = element_text(size = 8))
```

```{r explicit_implicit_all}
# by-subject correlations
subj_means_career_explicit <- iat_behavioral_tidy %>%
    mutate(explicit_dif = assocareer - assofamily) 

imp_exp_subjs <- cor.test(subj_means_career_explicit$overall_iat_D_score, 
         subj_means_career_explicit$explicit_dif)

# by country correlations
country_means_career_explicit <- subj_means_career_explicit %>%
  group_by(country_name) %>%
  summarize(mean_diff = mean(explicit_dif, na.rm = T),
            mean_iat = mean(overall_iat_D_score, na.rm = T))

imp_exp_country <- cor.test(country_means_career_explicit$mean_iat,
                            country_means_career_explicit$mean_diff) 

#ggplot(country_means_career_explicit , aes(x = mean_iat, y = mean_diff)) +
#  geom_point() +
#  geom_text(aes(label = country_name)) +
#  geom_smooth(method = "lm")
```



Broadly, we replicate the patterns in the IAT literature [@nosek2002harvesting]. First, participants in all countries showed a bias to associate men with career and females with family. Figure 1 shows the magnitude of the IAT gender bias (D-score) across all 49 countries (M = `r round(mean(country_means_career_implicit$mean_iat),2)`; SD = `r round(sd(country_means_career_implicit$mean_iat),2)`). Second, implicit and explicit bias measures  were correlated both at the level of individual participants (_r_ = `r round(as.numeric(imp_exp_subjs$estimate), 2)`; _p_ < .00001) and at the level of countries (_r_ = `r round(as.numeric(imp_exp_country$estimate), 2)`; _p_ = `r round(as.numeric(imp_exp_country$p.value), 2)`).

```{r, gender_bias}
```

Finally, previous work has shown  a difference for women

# Study 2a: Caliskan replication
In Study 2, we asked whether participants' implicit and explicit gender biases were correlated with biases found in participants native language. To do this, we turned to embeddings, 
[@caliskan2017semantics].

## Method
Wikipedia fasstext - pretrained corpora

## Results
all measures are correlated

## Study 2b: Predicting implicit bias with language iat



# Study 3: grammar and bias

# Study 4: exploring bias more directly


# Conclusion 


# References 

```{r}
# References will be generated automatically by Pandoc and included here.
# The following code is some latex to format the bibliography. Do not remove it.
```

\setlength{\parindent}{-0.1in} 
\setlength{\leftskip}{0.125in}
\noindent
